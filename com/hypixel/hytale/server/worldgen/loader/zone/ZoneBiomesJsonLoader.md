---
description: Architectural reference for ZoneBiomesJsonLoader
---

# ZoneBiomesJsonLoader

**Package:** com.hypixel.hytale.server.worldgen.loader.zone
**Type:** Transient

## Definition
```java
// Signature
public class ZoneBiomesJsonLoader extends JsonLoader<SeedStringResource, IWeightedMap<TileBiome>> {
```

## Architecture & Concepts

The ZoneBiomesJsonLoader is a specialized, stateful worker component within the server's world generation pipeline. Its primary function is to orchestrate the loading of all biome definitions associated with a single world generation zone. It acts as a composite loader, bridging the gap between a zone's high-level configuration and the detailed, in-memory biome objects required by the procedural generator.

This class embodies the **delegation pattern**. It does not parse the intricate details of a biome file itself. Instead, it iterates through a pre-compiled list of biome files, provided by a ZoneFileContext, and for each file, it instantiates and invokes a more specialized TileBiomeJsonLoader.

Its final output, an IWeightedMap of TileBiome objects, is a critical data structure used by subsequent world generation stages to select biomes based on defined probabilities. The use of a weighted map is fundamental to creating varied and non-uniform terrain.

## Lifecycle & Ownership
-   **Creation:** An instance of ZoneBiomesJsonLoader is created by a higher-level orchestrator, such as a master ZoneLoader, during the processing of a specific zone. It is instantiated with all necessary context, including the zone's file context, the world seed, and the path to the data folder.
-   **Scope:** The object's lifetime is extremely short and task-focused. It exists only for the duration of the call to its `load` method. It is a single-shot, use-and-discard object.
-   **Destruction:** The instance becomes eligible for garbage collection immediately after the `load` method returns the IWeightedMap. No long-term references should be held to this object.

## Internal State & Concurrency
-   **State:** The internal state, primarily the ZoneFileContext, is provided at construction and is treated as immutable for the object's lifetime. The loader is stateful but does not mutate its own state during its primary operation. All operations are focused on reading from the filesystem and constructing a new return object.
-   **Thread Safety:** This class is **not thread-safe** and must not be shared across threads. It is designed to be instantiated and used within a single, synchronous world generation thread. It performs blocking file I/O operations, and concurrent access would result in unpredictable behavior and potential resource contention.

## API Surface

The public contract is minimal, exposing only the core loading functionality inherited and implemented from its parent.

| Symbol | Type | Complexity | Description |
| :--- | :--- | :--- | :--- |
| load() | IWeightedMap<TileBiome> | O(N * M) | Orchestrates the loading of all biomes for the zone. Throws IllegalArgumentException if no biomes are found. Throws Error on file I/O or parsing failure. N is the number of biomes; M is the complexity of loading a single biome. |

## Integration Patterns

### Standard Usage

This loader is intended to be used by a parent system responsible for loading a complete zone. The parent first establishes the context and then invokes the loader to produce the biome map.

```java
// Assume 'zoneContext' is a valid, populated ZoneFileContext for the target zone.
// Assume 'seed', 'dataFolder', and 'zoneJson' are provided by the generator.

// 1. Instantiate the loader with all required context.
ZoneBiomesJsonLoader loader = new ZoneBiomesJsonLoader(seed, dataFolder, zoneJson, zoneContext);

// 2. Execute the load operation to get the final data structure.
IWeightedMap<TileBiome> biomesForZone = loader.load();

// 3. Pass the result to the next stage of the world generator.
worldGenerator.registerZoneBiomes(biomesForZone);
```

### Anti-Patterns (Do NOT do this)
-   **Object Re-use:** Do not retain a reference to a ZoneBiomesJsonLoader instance to call `load` multiple times. It is designed as a single-use object. Re-invoking `load` is redundant and inefficient.
-   **Manual Context Construction:** Do not attempt to manually create a ZoneFileContext to pass to this loader. The context must be generated by the engine's asset discovery systems to ensure correctness.
-   **Concurrent Execution:** Do not dispatch this loader to a worker thread pool or access a single instance from multiple threads. All world generation loading is expected to be synchronous and single-threaded.

## Data Pipeline

The ZoneBiomesJsonLoader is a key transformation step in the world generation asset pipeline. It converts file-system-based asset references into a runtime data structure.

> Flow:
> Zone Definition File -> Asset Discovery -> **ZoneFileContext** -> **ZoneBiomesJsonLoader** -> (delegates to) TileBiomeJsonLoader -> **IWeightedMap<TileBiome>** -> Procedural Generation Algorithm

