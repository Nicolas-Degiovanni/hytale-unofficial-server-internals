---
description: Architectural reference for ClearTransaction
---

# ClearTransaction

**Package:** com.hypixel.hytale.server.core.inventory.transaction
**Type:** Transient

## Definition
```java
// Signature
public class ClearTransaction implements Transaction {
```

## Architecture & Concepts
The ClearTransaction class is an immutable value object that represents the result of an operation to clear items from an ItemContainer. It is not a service or a manager; it is a data record that encapsulates the outcome of a state change.

Its primary architectural role is to serve as a data transfer object between the core inventory system and other systems that need to react to inventory changes, such as the networking layer or UI controllers. The key design feature is its ability to perform coordinate-space transformations via the *toParent* and *fromParent* methods. This allows a single transaction result, generated by a deeply nested container, to be re-interpreted relative to any of its parent containers. This is essential for correctly synchronizing complex, hierarchical inventories without requiring each layer to have intimate knowledge of its children's layout.

For example, a transaction occurring in a backpack (slots 0-4) can be transformed by *toParent* to be understood by the main player inventory (where the backpack might occupy slots 30-34).

## Lifecycle & Ownership
- **Creation:** Instances are created exclusively by ItemContainer implementations when a clear operation is performed. They are *result objects*, not objects that are manually instantiated by general application logic. The static field EMPTY provides a canonical representation of a no-op transaction.
- **Scope:** Extremely short-lived. A ClearTransaction typically exists only for the duration of the inventory modification call stack. It is created, passed to event listeners or serializers, and then becomes eligible for garbage collection.
- **Destruction:** Managed by the Java Garbage Collector. There are no native resources or explicit cleanup methods.

## Internal State & Concurrency
- **State:** **Immutable**. All fields are final and set during construction. Methods that perform transformations, such as *toParent*, do not modify the instance; they return a new ClearTransaction instance with the transformed data.

- **Thread Safety:** **Conditionally Thread-Safe**. As an immutable object, ClearTransaction is inherently safe to read from multiple threads. However, this safety relies on an external contract: the ItemStack array provided to its constructor must not be mutated by the caller after the ClearTransaction is created. The class itself performs no defensive copying of the input array to maintain performance.

## API Surface

| Symbol | Type | Complexity | Description |
| :--- | :--- | :--- | :--- |
| succeeded() | boolean | O(1) | Returns true if the clear operation that generated this transaction was successful. |
| wasSlotModified(short slot) | boolean | O(1) | Checks if a given slot index was affected by this transaction, relative to the container that created it. |
| getItems() | ItemStack[] | O(1) | Returns the array of items that were removed. **Warning:** This is a direct reference, not a copy. |
| toParent(...) | ClearTransaction | O(N) | Creates a new transaction with its slot coordinates translated into the coordinate space of a parent container. |
| fromParent(...) | ClearTransaction | O(N) | Creates a new transaction by translating coordinates from a parent's space into a child's. May slice the item array if the transaction only partially overlaps the child container. |

## Integration Patterns

### Standard Usage
ClearTransaction is not used directly but is consumed by systems listening for inventory events. The primary interaction is to check for success and then process the removed items.

```java
// A listener or subsystem receives a transaction after an inventory operation.
public void onInventoryChange(ClearTransaction transaction) {
    if (!transaction.succeeded()) {
        // The operation failed, do not proceed.
        return;
    }

    // The operation was successful, process the items.
    ItemStack[] removedItems = transaction.getItems();
    for (ItemStack item : removedItems) {
        if (item != null && !item.isEmpty()) {
            // Logic to drop item in the world, update quests, etc.
        }
    }
}
```

### Anti-Patterns (Do NOT do this)
- **Direct Instantiation:** Do not call `new ClearTransaction()`. These objects are strictly results returned from the inventory system. Manually creating them can lead to a state mismatch between the actual inventory and the transaction record.
- **State Mutation:** Do not modify the array returned by `getItems()`. This violates the immutability contract of the transaction and can cause unpredictable behavior in other systems that are processing the same transaction instance.
- **Ignoring Success State:** Do not process the `items` array without first calling `succeeded()`. If the transaction failed, the item array may not accurately reflect the state of the inventory.

## Data Pipeline
The ClearTransaction acts as a data payload that flows from the point of an inventory state change outwards to consumers.

> Flow:
> User Input -> `ItemContainer.clear()` -> **ClearTransaction** (Instance Created) -> Inventory Event Bus -> Network Serializer -> Client-Side Inventory Logic

