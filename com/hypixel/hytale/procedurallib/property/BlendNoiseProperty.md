---
description: Architectural reference for BlendNoiseProperty
---

# BlendNoiseProperty

**Package:** com.hypixel.hytale.procedurallib.property
**Type:** Transient

## Definition
```java
// Signature
public class BlendNoiseProperty implements NoiseProperty {
```

## Architecture & Concepts
The BlendNoiseProperty is a composite implementation of the NoiseProperty interface. It functions as a higher-order noise operator, combining multiple noise sources into a single, more complex output. This is a fundamental component for creating heterogeneous procedural environments, such as world generation with distinct biomes.

Its core architectural purpose is to use one noise function, the **alpha**, as a control map to select and blend between an array of other noise functions. The value generated by the alpha noise at a given coordinate determines which of the other noises contribute to the final output. If the alpha value falls between two defined thresholds, the class performs a linear interpolation between the two corresponding noise sources. This creates smooth, natural transitions between different procedural features.

For example, the alpha noise could represent elevation or temperature, while the `noises` array could contain different terrain patterns for deserts, forests, and mountains. BlendNoiseProperty acts as the logic that stitches these patterns together seamlessly across the world.

## Lifecycle & Ownership
- **Creation:** BlendNoiseProperty is instantiated directly via its constructor, typically during the configuration phase of a procedural generator. It is expected to be built by a factory or configuration loader that parses world generation rules, rather than by game logic during runtime.
- **Scope:** The lifetime of a BlendNoiseProperty instance is tied to the procedural generation context it belongs to. It is not a global or session-wide object. It persists as long as the specific world generator or biome definition that uses it is active.
- **Destruction:** The object is managed by the Java garbage collector. It becomes eligible for collection once all references to it, such as from a parent WorldGenerator object, are released.

## Internal State & Concurrency
- **State:** The internal state of this class is defined entirely at construction and is **effectively immutable**. The `alpha`, `noises`, and `thresholds` fields are final. The `normalize` array, while not final, is a derived cache that is calculated once in the constructor and never modified again. The `transient` keyword on `normalize` indicates it is a runtime-only cache that should not be part of the object's serialized form.
- **Thread Safety:** This class is **thread-safe and highly concurrent**. Its immutable state and the pure-function nature of its `get` methods guarantee that it can be safely called by multiple threads simultaneously without locks or synchronization. This is a critical design feature for parallelized world generation, where multiple chunks are often generated on separate worker threads.

## API Surface

| Symbol | Type | Complexity | Description |
| :--- | :--- | :--- | :--- |
| get(seed, x, y) | double | O(N) | Calculates the 2D blended noise value. N is the number of thresholds. |
| get(seed, x, y, z) | double | O(N) | Calculates the 3D blended noise value. N is the number of thresholds. |

## Integration Patterns

### Standard Usage
The class is designed to be composed. A developer defines a control noise, a set of result noises, and the thresholds that map between them. This composite property is then used by any system that consumes a NoiseProperty, such as a terrain heightmap generator.

```java
// Example: Create a simple two-layer blend
NoiseProperty controlNoise = new SimplexNoiseProperty(...);
NoiseProperty[] terrainNoises = {
    new ConstantNoiseProperty(10.0), // Water level
    new FBMNoiseProperty(...)        // Land terrain
};
double[] blendThresholds = { 0.5, 0.6 }; // Blend between 0.5 and 0.6

// The BlendNoiseProperty stitches them together
NoiseProperty finalTerrain = new BlendNoiseProperty(
    controlNoise,
    terrainNoises,
    blendThresholds
);

// Use the final composite noise property
double height = finalTerrain.get(seed, x, y);
```

### Anti-Patterns (Do NOT do this)
- **Unordered Thresholds:** The constructor requires that the `thresholds` array be in strictly ascending order. Providing an unsorted or incorrectly ordered array will throw an IllegalStateException. This is a hard-precondition that must be met.
- **Mismatched Array Lengths:** The number of `noises` must be exactly one greater than the number of `thresholds`. A mismatch will lead to an ArrayIndexOutOfBoundsException during the `get` call.
- **Excessive Complexity:** While powerful, using a BlendNoiseProperty with a very large number of noises and thresholds will degrade performance. The `get` methods have a linear O(N) time complexity relative to the number of thresholds. For performance-critical loops, keep the number of blended layers to a minimum.

## Data Pipeline
The BlendNoiseProperty is a transformation node within a larger procedural generation pipeline. It does not manage a data flow itself but rather executes a specific transformation on incoming coordinates.

> Flow:
> 1. Input Coordinate (x, y, z) & Seed ->
> 2. **BlendNoiseProperty.get()** is invoked.
> 3. The `alpha` NoiseProperty is queried with the coordinate, yielding a control value.
> 4. The control value is located within the `thresholds` array to find the correct segment.
> 5. The two `noises` corresponding to that segment are queried with the coordinate.
> 6. A blend factor is calculated using the pre-computed `normalize` value.
> 7. The two noise results are linearly interpolated.
> 8. -> Output: A single blended double value.

